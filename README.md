# SPWM-Generator
Using TI MSPM0 make SPWM wave

┌────────────────────────────────────────────────────────────────────────────┐
│                      MSPM0G (SYSCLK 32 MHz / BUSCLK 4 MHz)                 │
│                                                                            │
│  ┌──────────────┐      200 kHz ZERO_EVENT IRQ      ┌──────────────────┐    │
│  │  TIMA0       │ ─────────────────────────────────▶│   ISR (TIMA0)   │    │
│  │  Periodic    │      (Period = 19 @ 4 MHz)       │  (5 µs 주기)     │    │
│  └──────────────┘                                   └───────┬──────────┘    │
│                                                             │               │
│                                                             ▼               │
│                                     ┌────────────────────────────────────┐  │
│                                     │           SPWM Core               │  │
│                                     │  (센터정렬 캐리어 + 3상 비교)     │  │
│  ┌──────────────────────────────┐   │                                    │  │
│  │  Phase Accumulator           │   │  ┌──────────────────────────────┐  │  │
│  │  phase_acc += phase_inc      │   │  │ Triangle Generator           │  │  │
│  │  (phase_inc = f_sine/ISR)    │   │  │ tri_val ∈ [−TRI_TOP,+TRI_TOP]│  │  │
│  └──────────────┬───────────────┘   │  │ up/down, step=TRI_STEP       │  │  │
│                 │ index             │  └──────────────┬───────────────┘  │  │
│                 ▼                   │                 │                  │  │
│     ┌──────────────────────────┐    │   ┌─────────────▼────────────┐    │  │
│     │ 3-Phase Sine LUT         │    │   │ Comparator (per-phase)   │    │  │
│     │ A,B,C = sin(θ 0/±120°)   │    │   │ A_high = (A > tri_val)   │    │  │
│     └──────────────────────────┘    │   │ B_high, C_high 동일       │    │  │
│                                     │   └─────────────┬────────────┘    │  │
│                                     │                 │                  │  │
│                                     │   ┌─────────────▼────────────┐    │  │
│                                     │   │ Dead-time Inserter       │    │  │
│                                     │   │ both OFF → wait → ON     │    │  │
│                                     │   │ (DEADTIME_CYCLES @32MHz) │    │  │
│                                     │   └─────────────┬────────────┘    │  │
│                                     └─────────────────┼──────────────────┘  │
│                                                       │                     │
│                                                       ▼                     │
│                          ┌──────────────────────────────────────────┐       │
│                          │  GPIOB (한 포트 원샷)                    │       │
│                          │  INHA=PB9, INHB=PB2, INHC=PB3           │       │
│                          │  INLA=PB7, INLB=PB6, INLC=PB0           │       │
│                          └───────────────┬──────────────────────────┘       │
│                                          │                                  │
│                                          ▼                                  │
│                         ┌────────────────────────────────────┐               │
│                         │  DRV8300                           │               │
│                         │  INHA/INLA → Phase A gate          │               │
│                         │  INHB/INLB → Phase B gate          │               │
│                         │  INHC/INLC → Phase C gate          │               │
│                         │  EN_GATE (MCU GPIO)                │               │
│                         │  nFAULT  (MCU GPIO in)             │               │
│                         └────────────────────────────────────┘               │
│                                                                            │
│                         (디버그 경로)                                       │
│                         ┌────────────────────────────────────┐              │
│                         │ DAC0 (PA15)                        │              │
│                         │ tri_val → 12bit code → DAC OUT     │              │
│                         │ (IOMUX = PF_DAC0_OUT, no pull)     │              │
│                         └────────────────────────────────────┘              │
└────────────────────────────────────────────────────────────────────────────┘
